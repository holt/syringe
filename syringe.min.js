// syringe.js v0.3.5. Copyright (c) 2013 Michael Holt, holt.org. Distributed under the MIT License
(function(){var m=this,q=function(r){var k={}.hasOwnProperty,n=[].slice,g={},e={},j=[],h=function(a,b){var c;c=a?{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1]:null===a?"Null":"Undefined";return b?c.toLowerCase():c},l=function(a,b,c){b=b||this;a=a.split(c||".");return a.filter(function(b){return b.length}).reduce(function(b,a,c,g){if(b)return b[g[c]]},b)},s=function(a,b,c){b=b||this;a=a.split(c||".");var d,f;d=0;for(f=a.length;d<f;d++)c=a[d],b=b[c]=b[c]||{};return b},q=function(a){return a.map(function(b){return l(b, e)},this)},u=function(a,b){var c=window?window.document:!1;if(c){var d=c.getElementsByTagName("head")[0]||c.documentElement,f=c.createElement("script"),t=!1;f.src=a;f.onload=f.onreadystatechange=function(){if(!t&&(!this.readyState||"loaded"===this.readyState||"complete"===this.readyState))t=!0,f.onload=f.onreadystatechange=null,d&&f.parentNode&&d.removeChild(f),"function"===h(b,!0)&&b()};d.insertBefore(f,d.firstChild)}else return!1},p=function(a,b){var c=n.call(arguments),d=j.filter(function(a){return a.fn=== b})[0];b=d?d.fn:b;for(var f in b.prototype)this.constructor.prototype[f]=b.prototype[f];return b.apply(this,q(a).concat(c.slice(2,c.length)))},e=r&&"object"===h(r,!0)?r:e;g.register=g.add=function(a,b,c){if("object"===h(a,!0)){for(var d in a)k.call(a,d)&&this.add.apply(this,[d,a[d]]);return this}if(l(a,e))throw Error('Key "'+a+'" already exists in the map; use .remove() to unregister it first!');"function"===h(b,!0)&&c&&(b=this.on(c,b));a=a.split(".");(c=1<a.length?a.pop():!1)?s(a.join("."),e)[c]= b:e[a.toString()]=b;return this};g.unregister=g.remove=function(a){var b={},c={},d=a.trim().split(".");a=d.pop();c=(d=d.join("."))?l(d,e):e;a=a||d;for(var f in c)k.call(c,f)&&!(k.call(c,a)&&f===a)&&(b[f]=c[f]);d?this.set(d,b):e=b;return this};g.bind=g.on=function(){var a=m,b,c,d,f,g,a,e;b=n.call(arguments);c="String"===h(b[0])?!0:!1;switch(b.length){case 2:return e={fn:b[1],ctx:a,bind:p.bind(a,b[0],b[1])},j.push(e),e.bind;case 3:if(c)d=b[0],f=b[1],g=b[2],e={fn:b[2],ctx:a};else return e={fn:b[1],ctx:b[2], bind:p.bind(b[2],b[0],b[1])},j.push(e),e.bind;break;case 4:d=b[0],f=b[1],g=b[2],a=b[3],e={fn:b[2],ctx:b[3]}}b=d.split(".");c=1<b.length?b.pop():!1;e.bind=g=p.bind(a,f,g);j.push(e);c?s(b.join("."),a)[c]=g:a[b.join(".")]=g;return this};g.exec=function(a,b,c){c=c||this;b="array"===h(b,!0)?b:[b];var d=this.get(a);return"string"===h(a,!0)&&"function"===h(d,!0)?d.apply(c,b):!1};g.get=function(a){return"string"===h(a,!0)?(a=l(a,e),"undefined"!==h(a,!0)?a:!1):e};g.set=function(a,b){var c=a.split("."),d=1< c.length?c.pop():!1;if(void 0===l(a,e))throw Error('Key "'+a+'" does not exist in the map!');d?s(c.join("."),e)[d]=b:e[c.toString()]=b;return this};g.fetch=function(a,b){var c=this,d=0,f=function(){var f=++d,e=0,g;for(g in a)k.call(a,g)&&e++;if(f===e){for(var h in a)k.call(a,h)&&a[h].bind&&c.add(h,l(a[h].bind,m));b.call(c)}},e;for(e in a)k.call(a,e)&&u(a[e].path,f)};g.wrap=function(a,b,c){c=c||this;var d=j.filter(function(b){return b.bind===a})[0];return d?function(){var a=n.call(arguments);return b.apply(c, [function(){a=arguments.length?arguments:a;return d.bind.apply(c,a)}].concat(a))}:!1};g.copy=function(a,b,c){c=c||this;var d=n.call(arguments),e=j.filter(function(a){return a.bind===b})[0];return e?(d={fn:b,ctx:d[0],bind:p.bind(e.ctx,a,e.fn)},j.push(d),d.bind):!1};g.VERSION="0.3.4";return g};m.Syringe=q();m.Syringe.create=q}).call(this);