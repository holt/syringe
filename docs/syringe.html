<!DOCTYPE html>

<html>
<head>
  <title>syringe.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>syringe.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <blockquote>
<p><a href="http://syringejs.org">http://syringejs.org</a>
syringe.js v0.5.5. Copyright (c) 2013 Michael Holt
holt.org. Distributed under the MIT License</p>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/* jshint forin:true, noarg:true, noempty:true, eqeqeq:true, bitwise:false, strict:true,
undef:true, unused:true, curly:true, indent:4, maxerr:50, laxcomma:true, evil: true,
laxbreak:true, multistr: true, camelcase:true, immed: true, latedef: true, nonew:true,
quotmark: true, node: true, newcap: true, browser:true */</span>
(<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

	<span class="string">'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Globals</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span>
		root	= <span class="keyword">this</span>,
		store	= {},
		hasProp	= {}.hasOwnProperty,
		slice	= [].slice;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Utility methods used by the API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> utils = {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Get an object from an (optional) context <code>ctx</code> using delimited
string notation. The <code>sep</code> parameter determines the delimiter 
(a period <code>.</code> by default).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getObj: <span class="function"><span class="keyword">function</span> <span class="params">(str, ctx, sep)</span> {</span>
			<span class="keyword">return</span> str.split((sep || <span class="string">'.'</span>)).filter(<span class="function"><span class="keyword">function</span> <span class="params">(num)</span> {</span>
				<span class="keyword">return</span> num.length;
			}).reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, curr, index, list)</span> {</span>
				<span class="keyword">if</span> (prev) {
					<span class="keyword">return</span> prev[list[index]];
				}
			}, (ctx || <span class="keyword">this</span>));
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Create an object within an (optional) context <code>ctx</code> using 
delimited string notation. The <code>sep</code> parameter determines
the delimiter (period by default).            </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		setObj: <span class="function"><span class="keyword">function</span> <span class="params">(str, ctx, sep)</span> {</span>
			<span class="keyword">return</span> str.split((sep || <span class="string">'.'</span>)).reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, curr)</span> {</span>
				<span class="keyword">return</span> (prev[curr]) ? (prev[curr]) : (prev[curr]) = {};
			}, (ctx || <span class="keyword">this</span>));
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>In cases where no context is provided, we just want simple partial 
application and no clobbering of the original <code>this</code> context. This
utility function allows .call() and .apply() to continue to work
properly on bound Syringe functions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		bindArgs: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">var</span>
				args	= slice.call(arguments),
				fn	= <span class="keyword">this</span>;
			<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
				<span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, args.concat(slice.call(arguments)));
			};
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>RFC 4122 GUID generator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		makeId: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
			<span class="keyword">return</span> <span class="string">'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'</span>.replace(<span class="regexp">/[xy]/g</span>, <span class="function"><span class="keyword">function</span> <span class="params">(b)</span> {</span>
				<span class="keyword">var</span> a = <span class="number">16</span> * Math.random() | <span class="number">0</span>;
				<span class="keyword">return</span> (<span class="string">'x'</span> === b ? a : a &amp; <span class="number">3</span> | <span class="number">8</span>).toString(<span class="number">16</span>);
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Get the object type as a string. If an <code>istype</code> value is passed the comparison
is against this value and returns <code>true</code> or <code>false</code>, otherwise the type itself
is returned.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getType: <span class="function"><span class="keyword">function</span> <span class="params">(obj, istype)</span> {</span>
			<span class="keyword">var</span>
				ret	= <span class="string">'Undefined'</span>,
				types	= [<span class="string">'Window'</span>, <span class="string">'HTMLDocument'</span>, <span class="string">'Global'</span>, <span class="string">'Document'</span>];

			<span class="keyword">if</span> (obj) {

				ret = ({}).toString.call(obj).match(<span class="regexp">/\s([a-z|A-Z]+)/</span>)[<span class="number">1</span>];

				types = types.some(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
					<span class="keyword">return</span> item.toLowerCase() === ret.toLowerCase();
				});

				ret = types ? <span class="string">'Object'</span> : ret;
			} <span class="keyword">else</span> {
				<span class="keyword">if</span> (obj === <span class="literal">null</span>) {
					ret = <span class="string">'Null'</span>;
				} <span class="keyword">else</span> <span class="keyword">if</span> (obj === <span class="literal">false</span>) {
					ret = <span class="string">'Boolean'</span>;
				} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">'string'</span>) {
					ret = <span class="string">'String'</span>;
				} <span class="keyword">else</span> <span class="keyword">if</span> (obj === <span class="number">0</span>) {
					ret = <span class="string">'Number'</span>;
				} <span class="keyword">else</span> <span class="keyword">if</span> (isNaN(obj) &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">'number'</span>) {
					ret = <span class="string">'NaN'</span>;
				}
			}
			<span class="keyword">if</span> (<span class="keyword">typeof</span> istype === <span class="string">'string'</span>) {
				<span class="keyword">return</span> (istype.toLowerCase() === ret.toLowerCase());
			} <span class="keyword">else</span> {
				<span class="keyword">return</span> ret;
			}
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Return an array that describes the type of items contained inside an arguments
object, or match an arguments object to an array of type names in order to
validate the payload</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		matchArgs: <span class="function"><span class="keyword">function</span> <span class="params">(args, istype)</span> {</span>
			istype	= istype || [];
			args	= [].slice.call(args);
			<span class="keyword">if</span> (!istype.length) {
				<span class="keyword">return</span> args.map(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
					<span class="keyword">return</span> utils.getType(item);
				});
			} <span class="keyword">else</span> <span class="keyword">if</span> (istype.length === args.length) {
				<span class="keyword">return</span> args.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(prev, curr, idx)</span> {</span>
					<span class="keyword">if</span> (!prev &amp;&amp; utils.getType(istype[idx], <span class="string">'string'</span>)) {
						<span class="keyword">return</span> <span class="literal">false</span>;
					}
					<span class="keyword">return</span> utils.getType(curr, istype[idx]);
				}, <span class="literal">true</span>);

			} <span class="keyword">else</span> {
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Return a map of any items in the passed array that match items
in the registry object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getReg: <span class="function"><span class="keyword">function</span> <span class="params">(arr, id)</span> {</span>
			<span class="keyword">var</span> reg = store[id].registry;
			<span class="keyword">return</span> arr.map(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">switch</span> (item) {
				<span class="keyword">case</span> <span class="string">''</span>:
					<span class="keyword">return</span> <span class="literal">undefined</span>;
				<span class="keyword">case</span> <span class="string">'*'</span>:
					<span class="keyword">return</span> reg;
				<span class="keyword">case</span> <span class="string">'this'</span>:
					<span class="keyword">return</span> <span class="keyword">this</span>;
				<span class="keyword">default</span>:
					<span class="keyword">return</span> utils.getObj(item, reg, store[id].sep);
				}
			}, <span class="keyword">this</span>);
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Standard ajax retrieval operation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		getData: <span class="function"><span class="keyword">function</span> <span class="params">(url, callback)</span> {</span>
			<span class="keyword">var</span> xhr;
			<span class="keyword">if</span> (!utils.getType(XMLHttpRequest, <span class="string">'undefined'</span>)) {
				xhr = <span class="keyword">new</span> XMLHttpRequest();
			} <span class="keyword">else</span> {
				[
					<span class="string">'MSXML2.XmlHttp.5.0'</span>,
					<span class="string">'MSXML2.XmlHttp.4.0'</span>,
					<span class="string">'MSXML2.XmlHttp.3.0'</span>,
					<span class="string">'MSXML2.XmlHttp.2.0'</span>,
					<span class="string">'Microsoft.XmlHttp'</span>
				].forEach(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
					<span class="keyword">try</span> {
						xhr = <span class="keyword">new</span> window.ActiveXObject(item);
						<span class="keyword">return</span>;
					} <span class="keyword">catch</span> (e) {}
				});
			}

			xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
				<span class="keyword">if</span> (xhr.readyState &lt; <span class="number">4</span>) {
					<span class="keyword">return</span>;
				}
				<span class="keyword">if</span> (xhr.status !== <span class="number">200</span>) {
					callback(<span class="literal">null</span>);
				} <span class="keyword">else</span> <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) {
					callback(xhr);
				}
			};

			xhr.open(<span class="string">'GET'</span>, url, <span class="literal">true</span>);
			xhr.setRequestHeader(<span class="string">'Accept'</span>, <span class="string">'application/json, text/javascript, */*; q=0.01'</span>);
			xhr.setRequestHeader(<span class="string">'Content-Type'</span>, <span class="string">'application/json; charset=utf-8'</span>);
			xhr.send(<span class="string">''</span>);
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Returns <code>true</code> if an object contains no enumerable propeties</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		isEmpty: <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span> {</span>
			<span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) {
				<span class="keyword">if</span> (hasProp.call(obj, key)) {
					<span class="keyword">return</span> <span class="literal">false</span>;
				}
			}
			<span class="keyword">return</span> <span class="literal">true</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Asynch fetch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		fetch: <span class="function"><span class="keyword">function</span> <span class="params">(arr, props, ctx)</span> {</span>
			props		= props || {};
			props.success	= props.success || <span class="literal">false</span>;
			props.xss	= props.xss || <span class="literal">false</span>;

			<span class="keyword">var</span>
				self	= <span class="keyword">this</span>,
				count	= <span class="number">0</span>,
				url	= <span class="string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Test to see if a passed URL is local</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> isLocalURL = <span class="function"><span class="keyword">function</span> <span class="params">(url)</span> {</span>
				<span class="keyword">var</span> regexp = <span class="keyword">new</span> RegExp(<span class="string">'//'</span> + location.host + <span class="string">'($|/)'</span>);
				<span class="keyword">return</span> <span class="string">'http'</span> === url.substring(<span class="number">0</span>, <span class="number">4</span>) ? regexp.test(url) : <span class="literal">true</span>;
			};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Keep a count of the script load events and reconcile it
against the length of the script list</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> stack = <span class="function"><span class="keyword">function</span> <span class="params">(xhr)</span> {</span>
				<span class="keyword">if</span> (xhr &amp;&amp; xhr.responseText) {
					<span class="keyword">var</span> data = JSON.parse(xhr.responseText);
					<span class="keyword">if</span> (data) {
						self.add(arr[count].bind, data);
					}
				}
				<span class="keyword">if</span> (++count === arr.length) {
					<span class="keyword">if</span> (utils.getType(props.success, <span class="string">'function'</span>)) {
						props.success.call(self, (ctx || self));
					}
				}
			};

			arr.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">if</span> (isLocalURL(url = item.path) || props.xss === <span class="literal">true</span>) {
					utils.getData(item.path, stack);
				}
			});
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>The <code>run</code> function resolves the dependencies of a bound method.
When it executes is retrieves the original <code>fn</code> method from the 
<code>cabinet</code> object, and applies both the injected and free arguments
to it. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		run: <span class="function"><span class="keyword">function</span> <span class="params">(arr, fn, syr)</span> {</span>
			<span class="keyword">var</span>
				args = slice.call(arguments),
				props, match, ins, res;</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Remove the id from the arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			args.splice(<span class="number">2</span>, <span class="number">1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Locate the stored injection target function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			match = store[syr.id].cabinet.filter(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">return</span> item.fn === fn;
			})[<span class="number">0</span>];

			fn = match ? match.fn : fn;
			props = utils.getReg
				.apply(syr, [arr, syr.id])
				.concat(args.slice(<span class="number">2</span>, args.length));</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Replace pointers to the global object with actual instances</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			arr.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(item, idx)</span> {</span>
				<span class="keyword">if</span> (utils.getType(item, <span class="string">'string'</span>) &amp;&amp; item.indexOf(<span class="string">'global:'</span>) === <span class="number">0</span>) {
					props[idx] = utils.getObj(item.slice(<span class="number">7</span>, item.length), root, <span class="string">'.'</span>);

				}
			});

			<span class="keyword">if</span> (!utils.isEmpty(fn.prototype)) {
				ins = Object.create(fn.prototype);
				res = fn.apply(ins, props);
				<span class="keyword">return</span> (utils.getType(res, <span class="string">'object'</span>)) ? res : ins;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Assume a regular function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> {
				<span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, props);
			}
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Syringe base constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> Syringe = <span class="function"><span class="keyword">function</span> <span class="params">(props)</span> {</span>
		store[<span class="keyword">this</span>.id = utils.makeId()] = {
			cabinet: [],
			registry: (props &amp;&amp; utils.getType(props, <span class="string">'object'</span>)) ? props : {},
			separator: <span class="string">'.'</span>
		};
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Syringe object prototype methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> proto = Syringe.prototype = {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Set the separator character used for creating, specifying, and
retrieving objects. Whitespace and alphanumeric characters are
not permitted. By default, the period &#39;.&#39; character is used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		separator: <span class="function"><span class="keyword">function</span> <span class="params">(val)</span> {</span>
			<span class="keyword">return</span> (utils.getType(val, <span class="string">'string'</span>) &amp;&amp;
				(<span class="number">1</span> === val.replace(<span class="regexp">/[?a-zA-Z\d]|\s/g</span>, <span class="string">''</span>).length)) ?
				(store[<span class="keyword">this</span>.id].separator = val, <span class="keyword">this</span>) : <span class="literal">false</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Add a new item to the Syringe registry. The name can be provided 
in dot-notation, in which case a deep reference is built within
the registry. If <code>value</code> is a function, the optional <code>bindings</code> 
parameter can contain an array of all the registry properties 
with which to bind this function. In this way, registry methods
can be automatically bound to other registry methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		add: function (name, value, bindings) {
			var
				reg = store[this.id].registry,
				sep = store[this.id].separator;

			if (utils.getType(name, 'object')) {
				Object.keys(name).forEach(function (key) {
					this.add.apply(this, [key, name[key]]);
				}, this);
				return this;
			}

			if (!utils.getType(name, 'string')) {
				throw new Error('Name must be a string!');
			}

			name = name.trim();

			if (name.indexOf('global:') === 0) {
				throw new Error('You can\'t add a key with this prefix!');
			}

			if (utils.getObj(name, reg, sep)) {
				throw new Error('Key "' + name +
					'" already exists in the map; use \
					.remove() to unregister it first!');
			} else {
				if (utils.getType(value, 'function') &amp;&amp; bindings) {
					value = this.on(bindings, value);
				}
				var
				arr = name.split(sep),
					str = (arr.length &gt; 1) ? arr.pop() : false;

				if (str) {
					utils.setObj(arr.join(sep), reg, sep)[str] = value;
				} else {
					reg[arr.toString()] = value;
				}
			}
			return this;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Remove a named item from the registry</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		remove: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Remove an array of items</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (utils.getType(name, <span class="string">'array'</span>)) {
				name.forEach(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
					<span class="keyword">if</span> (utils.getType(item, <span class="string">'string'</span>)) {
						<span class="keyword">this</span>.remove(item);
					}
				}, <span class="keyword">this</span>);
				<span class="keyword">return</span>;
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Remove a single item</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (utils.getType(name, <span class="string">'string'</span>)) {

				name = name.trim();

				<span class="keyword">var</span>
					reg = store[<span class="keyword">this</span>.id].registry,
					sep = store[<span class="keyword">this</span>.id].separator,
					snm = name.trim().split(sep),
					lst = snm.pop(),
					nrg = {},
					obj = {};

				snm = snm.join(sep);
				obj = snm ? utils.getObj(snm, reg, sep) : reg;

				name = lst || snm;

				Object.keys(obj).forEach(<span class="function"><span class="keyword">function</span> <span class="params">(key)</span> {</span>
					<span class="keyword">if</span> (key !== name) {
						nrg[key] = obj[key];
					}
				});</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Deep removal (delimited name)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">if</span> (snm) {
					<span class="keyword">this</span>.set(snm, nrg);
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Shallow removal (non-delimited name)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">else</span> {
					store[<span class="keyword">this</span>.id].registry = nrg;
				}

			}

			<span class="keyword">return</span> <span class="keyword">this</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Bind a method to the dependency registry. This function accepts
a variety of different arguments, the formulation of which 
determine what type of binding takes place. The variations are
described below.        </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		on: <span class="function"><span class="keyword">function</span> <span class="params">( <span class="comment">/* 1, 2, 3, or 4 params */</span> )</span> {</span>
			<span class="keyword">var</span>
				cab	= store[<span class="keyword">this</span>.id].cabinet,
				args	= slice.call(arguments),
				ctx	= root,
				obj	= {args: args},
				anon, anonctx, named, namedctx, map;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Bind arguments only, no context - used when a context is
provided</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> bindArgsOnly = utils.bindArgs.bind(utils.run);</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Utility that adds named methods to a provided context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> namedFuncFactory = <span class="function"><span class="keyword">function</span> <span class="params">(name, fn, target)</span> {</span>
				<span class="keyword">var</span>
					sep = store[<span class="keyword">this</span>.id].separator,
					arr = name.split(sep),
					str = (arr.length &gt; <span class="number">1</span>) ? arr.pop() : <span class="literal">false</span>;

				target = utils.getType(target, <span class="string">'object'</span>) ? target : root;

				<span class="keyword">if</span> (str) {
					utils.setObj(arr.join(sep), target, sep)[str] = fn;
				} <span class="keyword">else</span> {
					target[arr.join(sep)] = fn;
				}

			}.bind(<span class="keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p><strong>One</strong> parameter: a map (property) object.</p>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p><strong>Two</strong> parameters: the registry array <code>args[0]</code> and method
<code>args[1]</code>. No name or context object is provided. The
bound function will be returned as an anonymous function.</p>

            </div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p><strong>Three</strong> parameters (1): the registry array <code>args[0]</code>, the
method <code>args[1]</code>, and a context object <code>args[2]</code>.
When the bound method executes the provided context
will be used.</p>

            </div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p><strong>Three</strong> parameters (2): a name <code>args[0]</code>, the registry array
<code>args[1]</code>, and method <code>args[2]</code>. No context object
is provided. The bound function will be assigned to
whatever the root object is.</p>

            </div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p><strong>Four</strong> parameters: a name <code>args[0]</code>, the registry array
<code>args[1]</code>, the method <code>args[2]</code>, and a context object
<code>args[3]</code>. When the bound method executes the provided
context will be used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
			map		= utils.matchArgs(args, [<span class="string">'object'</span>]);
			anon		= utils.matchArgs(args, [<span class="string">'array'</span>, <span class="string">'function'</span>]);
			anonctx		= utils.matchArgs(args, [<span class="string">'array'</span>, <span class="string">'function'</span>, <span class="string">'object'</span>]);
			named		= utils.matchArgs(args, [<span class="string">'string'</span>, <span class="string">'array'</span>, <span class="string">'function'</span>]);
			namedctx	= utils.matchArgs(args, [<span class="string">'string'</span>, <span class="string">'array'</span>, <span class="string">'function'</span>, <span class="string">'object'</span>]);


			<span class="keyword">if</span> (anon || anonctx || named || namedctx) {

				<span class="keyword">var</span> n = (named || namedctx) ? <span class="number">1</span> : <span class="number">0</span>;

				obj.fn = args[n + <span class="number">1</span>];
				obj.ctx = anonctx ? args[n + <span class="number">2</span>] : ctx;

				<span class="keyword">if</span> (anon || named) {
					obj.bind = bindArgsOnly(args[n + <span class="number">0</span>], args[n + <span class="number">1</span>], <span class="keyword">this</span>);
				} <span class="keyword">else</span> <span class="keyword">if</span> (anonctx || namedctx) {
					obj.bind = utils.run.bind(args[n + <span class="number">2</span>], args[n + <span class="number">0</span>], args[n + <span class="number">1</span>], <span class="keyword">this</span>);
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Store a copy of this binding in the <code>cabinet</code> object.
This is useful if we want to copy an existing bound
function but use new registry items. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				cab.push(obj);</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>if this is a named method?, If so, add the bound function to the name            </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">if</span> (n) {
					namedFuncFactory(args[<span class="number">0</span>], obj.bind, ctx);
					<span class="keyword">return</span> <span class="keyword">this</span>;
				} <span class="keyword">else</span> {
					<span class="keyword">return</span> obj.bind;
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Is this a property map?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">else</span> <span class="keyword">if</span> (map) {
				<span class="keyword">var</span>
					props		= utils.getType(args[<span class="number">0</span>], <span class="string">'object'</span>) ? args[<span class="number">0</span>] : {},
					name		= utils.getType(props.name, <span class="string">'string'</span>) ? props.name : <span class="literal">false</span>,
					bindings	= utils.getType(props.bindings, <span class="string">'array'</span>) ? props.bindings : <span class="literal">false</span>,
					fn		= utils.getType(props.fn, <span class="string">'function'</span>) ? props.fn : <span class="literal">false</span>,
					target		= utils.getType(props.target, <span class="string">'object'</span>) ? props.target : <span class="literal">false</span>;

				ctx = utils.getType(props.ctx, <span class="string">'object'</span>) ? props.ctx : ctx;

				<span class="keyword">if</span> (bindings.length &amp;&amp; fn) {

					obj.fn = fn;
					obj.ctx = ctx;

					<span class="keyword">if</span> (props.ctx) {
						obj.bind = utils.run.bind(props.ctx, bindings, fn, <span class="keyword">this</span>);
					} <span class="keyword">else</span> {
						obj.bind = bindArgsOnly(bindings, fn, <span class="keyword">this</span>);
					}

					cab.push(obj);</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>if this is a named method?, If so, add the bound function to the name            </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="keyword">if</span> (name) {
						namedFuncFactory(name, obj.bind, target);
						<span class="keyword">return</span> <span class="keyword">this</span>;
					} <span class="keyword">else</span> {
						<span class="keyword">return</span> obj.bind;
					}
				}
			}</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>If nothing gets returned, just return the Syringe object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">return</span> <span class="keyword">this</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Sometimes you need to call an executable registry item directly.
You can use this method to do just that. You can also (optionally) 
pass an array of arguments and a context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		exec: <span class="function"><span class="keyword">function</span> <span class="params">(name, args, ctx)</span> {</span>
			ctx = ctx || <span class="keyword">this</span>;
			<span class="keyword">var</span> fn = <span class="keyword">this</span>.get(name);
			<span class="keyword">var</span> _fn = store[<span class="keyword">this</span>.id].cabinet.filter(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">return</span> item.bind === fn;
			})[<span class="number">0</span>];

			args = (utils.getType(args, <span class="string">'array'</span>)) ? args : [args];

			<span class="keyword">if</span> ((utils.getType(name, <span class="string">'string'</span>)) &amp;&amp; (utils.getType(fn, <span class="string">'function'</span>))) {
				<span class="keyword">if</span> (_fn) {
					fn = _fn ? _fn.fn : fn;
					<span class="keyword">return</span> utils.run
						.apply(ctx, [_fn.args[<span class="number">0</span>], fn, <span class="keyword">this</span>]
							.concat(args));
				}
				<span class="keyword">return</span> fn.apply(ctx, args);
			}
			<span class="keyword">return</span> <span class="literal">false</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Retrieve a named item from the registry. You can use dot-notation
in the passed string. The method will return <code>false</code> if the item
does not exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		get: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
			<span class="keyword">var</span> reg = store[<span class="keyword">this</span>.id].registry;
			<span class="keyword">if</span> (utils.getType(name, <span class="string">'string'</span>)) {
				<span class="keyword">var</span> obj = utils.getObj(name, reg, store[<span class="keyword">this</span>.id].separator);
				<span class="keyword">if</span> (!utils.getType(obj, <span class="string">'undefined'</span>)) {
					<span class="keyword">return</span> obj;
				}
				<span class="keyword">return</span> <span class="literal">false</span>;
			}
			<span class="keyword">return</span> reg;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Set a named item from the registry. As with <code>get</code>, you can 
use dot-notation in the passed string. The method will throw
an exception if you try to set something that doesn&#39;t
exist.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		set: <span class="function"><span class="keyword">function</span> <span class="params">(name, value, bindings)</span> {</span>
			<span class="keyword">var</span>
				reg = store[<span class="keyword">this</span>.id].registry,
				sep = store[<span class="keyword">this</span>.id].separator,
				arr = name.split(sep),
				str = (arr.length &gt; <span class="number">1</span>) ? arr.pop() : <span class="literal">false</span>,
				prn;</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Test the existence of the key we&#39;re trying to set. The getObj function
simply returns the key value, which could be <code>undefined</code>. Thus, we need to
first establish if the value is undefined because the key doesn&#39;t exist,
or if it <em>does</em> exist but its value is <code>undefined</code>. In the former case we
throw an error.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">if</span> (utils.getObj(name, reg, sep) === <span class="literal">undefined</span>) {
				prn = utils.getObj(arr.join(sep), reg, sep);

				<span class="keyword">if</span> (str) {
					<span class="keyword">if</span> ((prn &amp;&amp; !hasProp.call(prn, str)) || !prn) {
						<span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Key "'</span> + name +
							<span class="string">'" does not exist in the map!'</span>);
					}
				} <span class="keyword">else</span> <span class="keyword">if</span> (!hasProp.call(reg, arr.toString())) {
					<span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Key "'</span> + name +
						<span class="string">'" does not exist in the map!'</span>);
				}
			}

			<span class="keyword">if</span> (utils.getType(value, <span class="string">'function'</span>) &amp;&amp; bindings) {
				value = <span class="keyword">this</span>.on(bindings, value);
			}

			<span class="keyword">if</span> (str) {
				utils.setObj(arr.join(sep), reg, sep)[str] = value;
			} <span class="keyword">else</span> {
				reg[arr.toString()] = value;
			}
			<span class="keyword">return</span> <span class="keyword">this</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Wrap a previously bound method in another <code>wrapper</code> function.
The original function is passed as the first argument to the
wrapper.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		wrap: <span class="function"><span class="keyword">function</span> <span class="params">(fn, wrapper, ctx)</span> {</span>
			ctx = ctx || <span class="keyword">this</span>;
			<span class="keyword">var</span> match = store[<span class="keyword">this</span>.id].cabinet.filter(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">return</span> item.bind === fn;
			})[<span class="number">0</span>];

			<span class="keyword">if</span> (match) {
				<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
					<span class="keyword">var</span> args = slice.call(arguments);
					<span class="keyword">return</span> wrapper.apply(ctx, [

						<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
							args = arguments.length ? arguments : args;
							<span class="keyword">return</span> match.bind.apply(ctx, args);
						}
					].concat(args));
				};
			}
			<span class="keyword">return</span> <span class="literal">false</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Copy an existing bound function <code>fn</code> where the copy
has different registry bindings, provided by the
<code>bindings</code> argument. You can also provide an optional
execution context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		copy: <span class="function"><span class="keyword">function</span> <span class="params">(bindings, fn, ctx)</span> {</span>
			ctx = ctx || <span class="keyword">this</span>;
			<span class="keyword">var</span> cab = store[<span class="keyword">this</span>.id].cabinet;
			<span class="keyword">var</span> match = cab.filter(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">return</span> item.bind === fn;
			})[<span class="number">0</span>];

			<span class="keyword">if</span> (match) {
				<span class="keyword">var</span> obj = {
					fn: fn,
					ctx: slice.call(arguments)[<span class="number">0</span>],
					bind: utils.run.bind(match.ctx, bindings, match.fn, <span class="keyword">this</span>)
				};
				cab.push(obj);
				<span class="keyword">return</span> obj.bind;
			}
			<span class="keyword">return</span> <span class="literal">false</span>;
		},</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Create a new Syringe object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		create: <span class="function"><span class="keyword">function</span> <span class="params">(props)</span> {</span>
			<span class="keyword">return</span> <span class="keyword">new</span> Syringe(props);
		}
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Allow mixins to be added to the prototype</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	proto.mixin = <span class="function"><span class="keyword">function</span> <span class="params">(obj)</span> {</span>
		<span class="keyword">if</span> (utils.getType(obj, <span class="string">'object'</span>)) {
			Object.keys(obj).forEach(<span class="function"><span class="keyword">function</span> <span class="params">(key)</span> {</span>
				<span class="keyword">if</span> (utils.getType(obj[key], <span class="string">'function'</span>)) {
					proto[key] = obj[key];
				}
			});
			<span class="keyword">return</span> <span class="keyword">this</span>;
		}
		<span class="keyword">return</span> <span class="literal">false</span>;
	};</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Create some method aliases</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	proto.bind = proto.on;
	proto.register = proto.add;
	proto.unregister = proto.remove;</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Add the current semver</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	proto.VERSION = <span class="string">'0.5.5'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Determine local context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (<span class="keyword">this</span>.window) {
		proto.fetch = utils.fetch;
		root.Syringe = <span class="keyword">new</span> Syringe();
	} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> module !== <span class="string">'undefined'</span> &amp;&amp; module.exports) {
		exports = module.exports = <span class="keyword">new</span> Syringe();
	}

}.call(<span class="keyword">this</span>));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
